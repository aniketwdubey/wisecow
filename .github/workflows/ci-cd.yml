name: CI/CD

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Build and Push Docker Image
      uses: docker/build-push-action@v2
      with:
        context: .
        push: true
        tags: wisecow:latest

    - name: Deploy to Kubernetes
      # uses: appleboy/kubectl-action@v0.12
      uses: benbjaple/action-kube-deploy@v2.0.2 
      manifests: k8s/
      # with:
      #   kubeconfig: ${{ secrets.KUBE_CONFIG }}
      #   config: k8s
      #   command: apply
      #   args: -f k8s/
